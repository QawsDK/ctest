<!DOCTYPE html>
	<head>
		<meta charset="utf-8" />
		<title>Gedebuk</title>
		<link rel="stylesheet" type="text/css" href="css/dx.common.css" />
		<link rel="stylesheet" type="text/css" href="css/dx.ios.default.css" />
		<link rel="stylesheet" type="text/css" href="css/dx.android.holo-dark.css" />
		<link rel="stylesheet" type="text/css" href="css/dx.desktop.default.css" />
		<link rel="stylesheet" type="text/css" href="css/dx.win8.black.small.css" />
		<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
		<script type="text/javascript" src="js/knockout-2.2.1.js"></script>
		<script type="text/javascript" src="js/globalize.min.js"></script>
		<script type="text/javascript" src="js/dx.phonejs.js"></script>
		<script src="js/leaflet.js"></script>
		<link rel="stylesheet" href="css/leaflet.css" />
		<script src="http://maps.google.com/maps/api/js?v=3&amp;sensor=true"></script>
		<script src="js/L.Control.Locate.js"></script>
		<link rel="stylesheet" href="css/L.Control.Locate.css">
		<script src="js/google.js"></script>
		<script type="text/javascript">
			$(document).ready(function () { 
			   ko.applyBindings(viewModel);
			});

			function MyViewModel() {
				var self = this;
				self.mapOne = ko.observable({
					lat: ko.observable(55.39955),
					lng:ko.observable(10.389848)
				});
			}

			ko.bindingHandlers.map = {
						init: function (element, valueAccessor, allBindingsAccessor, viewModel) {
							var mapObj = ko.utils.unwrapObservable(valueAccessor());
							
							
							var kort = L.map('map1Div').setView([ko.utils.unwrapObservable(mapObj.lat), ko.utils.unwrapObservable(mapObj.lng)], 17);
							var osmUrl = 'http://{s}.tile.osm.org/{z}/{x}/{y}.png',
							osmAttribution = '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a>';
							var osm = L.tileLayer(osmUrl, {attribution: osmAttribution}).addTo(kort);
							
							
							
							var ghyp = new L.Google();	
							var mapquestUrl = 'http://{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png',
							mapquestAttribution = '<p>© OpenStreetMap, Tiles Courtesy of <a href="http://www.mapquest.com/" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png"></p>',
							subDomains = ['otile1','otile2','otile3','otile4'];

							var mapquest = L.tileLayer(mapquestUrl, {attribution: mapquestAttribution, subdomains: subDomains});
							//Initiate map
							
							var baseLayers = {
								"MapQuestOpen": mapquest,
								"Google Hybrid": ghyp
							};
							
							kort.removeLayer(ghyp);
							
							L.control.layers(baseLayers).addTo(kort);
							
							
							
							$("#" + element.getAttribute("id")).data("mapObj",mapObj);
							
							L.Util.requestAnimFrame(kort.invalidateSize, kort, false, kort._container)
						}
					};


			var viewModel = new MyViewModel();
		</script>
	</head>
<body>
	<div id="map1Div" data-bind="style:{width:'800px',height:'800px'},map:mapOne"></div>
	<!--
	<input data-bind="value: mapOne().lat" />
	<input data-bind="value: mapOne().lng" />
	-->
</body>
</html>